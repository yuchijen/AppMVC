@using AppMVC.ViewModels.SPA
@model MainViewModel
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link href="~/Content/themes/base/all.css" rel="stylesheet" />    
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    <title>Employee Single Page Application</title>
</head>
<body>
    <div class="navbar-collapse collapse" style="text-align:left">
        <ul class="nav navbar-nav">
            <li>@Html.ActionLink("Home", "Index", "Home", new { area="" }, null)</li>
            <li>@Html.ActionLink("AngualarJs Page", "Index", "NgPage", new { area = "" }, null)</li>
            <li>@Html.ActionLink("SPA MVC", "Index", "SPA/Main", new { area = "" }, null)</li>
        </ul>
    </div>
    <div style="text-align:right">
        Hello, @Model.UserName
        <a href="/Authentication/Logout">Logout</a>
    </div>
    <hr />
    <div id="DivOption">
        @Html.Action("EmployeeList", "Main")
    </div>
    @Html.Partial("Footer", Model.FooterData)

    <script src="~/Scripts/jquery-1.12.4.js"></script>
    <script src="~/Scripts/jquery-ui-1.12.1.js"></script>
    <script>
        $(function () {
            $(document).ajaxStart(function () {
                $("<div id='loadingDiv'><img src=\"../Content/themes/base/images/loading.gif\" /></div>").dialog(
                    {
                        width: 'auto', height: 'auto', modal: true,
                        //remove dialog title bar, but keep close button
                        create: function (event, ui) {
                            var dialog = $(this).closest(".ui-dialog");
                            dialog.find(".ui-dialog-titlebar-close")
                                .appendTo(dialog)
                                .css({
                                    position: "absolute",
                                    top: 0,
                                    right: 0,
                                    margin: "3px"
                                });
                            dialog.find(".ui-dialog-titlebar").remove();
                        }
                    });
            });
            $(document).ajaxStop(function () {
                $('#loadingDiv').remove();
            });            
        });
        
        function OpenAddNew() {
            $.get("/SPA/Main/AddNew").then
                (
                function (r) {
                    $("<div id='DivCreateEmployee'></div>").html(r).
                        dialog({
                            width: 'auto', height: 'auto', modal: true, title: "Create New Employee",
                            close: function () {
                                $('#DivCreateEmployee').remove();
                            }
                        });
                    }
                ).fail(                
                function (response) {
                    $('#loadingDiv').remove();
                        alert('Loading Add Page Error: ' + response.responseText);
                });                    
        }

        function OpenBulkUpload() {
            $.get("/SPA/SpaBulkUpload/Index").then
                (
                function (r) {
                    $("<div id='DivBulkUpload'></div>").html(r).dialog({
                        width: 'auto', height: 'auto', modal: true, title: "Create New Employee",
                        close: function () {
                            $('#DivBulkUpload').remove();
                        }
                    });
                }
                ).fail(
                function (response) {
                    alert('Error: ' + response.responseText);
                });
        }
    </script>

</body>
</html>